---
phase: 02-navigation
plan: 02
type: execute
wave: 2
depends_on:
  - "02-01"
files_modified:
  - src/components/navigation/constants.ts
  - src/components/navigation/navigation-header.tsx
  - src/components/layout.tsx
autonomous: true
requirements:
  - NAV-03

must_haves:
  truths:
    - "A horizontal row of category pills with icons is visible below the main header bar on all breakpoints"
    - "The pill row scrolls horizontally on mobile without causing full-page horizontal scroll"
    - "Clicking a category pill navigates to the search page filtered by that category"
    - "The active category pill is highlighted with brand color tokens"
    - "All 5 service categories (grooming, training, boarding, veterinary, adoption) appear as pills"
    - "Page content does not hide behind the expanded header"
  artifacts:
    - path: "src/components/navigation/constants.ts"
      provides: "All 5 category items uncommented in navigationItems array"
      contains: "training"
    - path: "src/components/navigation/navigation-header.tsx"
      provides: "CategoryPillRow rendered below main header bar"
      contains: "overflow-x-auto"
    - path: "src/components/layout.tsx"
      provides: "Updated padding-top to account for two-row header height"
      contains: "pt-28"
  key_links:
    - from: "src/components/navigation/navigation-header.tsx"
      to: "src/components/navigation/constants.ts"
      via: "import navigationItems"
      pattern: "navigationItems"
    - from: "src/components/navigation/navigation-header.tsx"
      to: "/search?category="
      via: "Link href from navigationItems"
      pattern: "item\\.href"
    - from: "src/components/layout.tsx"
      to: "src/components/navigation/navigation-header.tsx"
      via: "padding-top matching total header height"
      pattern: "pt-28"
---

<objective>
Add an Airbnb-style horizontal scrollable category pill row to the header and uncomment all service categories.

Purpose: NAV-03 requires a horizontally scrollable row of service category pills with icons visible in the header. The data already exists in `constants.ts` but 4 of 5 categories are commented out. A new pill row component is needed inside the header, and the layout padding must be updated to account for the increased header height.

Output: A second row in the header containing 5 category pills with icons, horizontally scrollable on mobile, with brand-colored active states and correct layout offset.
</objective>

<execution_context>
@/Users/gvozdovic/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gvozdovic/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-navigation/02-RESEARCH.md
@.planning/phases/02-navigation/02-01-SUMMARY.md
@src/components/navigation/constants.ts
@src/components/navigation/navigation-header.tsx
@src/components/layout.tsx
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Uncomment all category items in constants.ts and add pill row to NavigationHeader</name>
  <files>
    src/components/navigation/constants.ts
    src/components/navigation/navigation-header.tsx
  </files>
  <action>
**In `src/components/navigation/constants.ts`:**

Uncomment all 4 hidden navigation items (training, boarding, veterinary, adoption) and the hidden service types. Also uncomment all service types in the `serviceTypes` array. The final arrays should have:

`serviceTypes`: 6 items — grooming, veterinary, boarding, training, adoption, sitting

`navigationItems`: 5 items — grooming, training, boarding, veterinary, adoption (no sitting — no icon available per Research open question #2)

Remove the comment lines like `// Other service types hidden - only showing grooming` and `// Other navigation items hidden - only showing grooming`.

Add a trailing comma after each item for clean diffs.

**In `src/components/navigation/navigation-header.tsx`:**

1. Add these imports at the top (some may already exist — don't duplicate):
```typescript
import { useSearchParams } from 'next/navigation'
import { navigationItems } from './constants'
import type { NavigationItem } from './types'
```

Note: `usePathname` and `Image` are already imported. `useSearchParams` is new.

2. Add `useSearchParams()` inside the component:
```typescript
const searchParams = useSearchParams()
```

3. Add an `isActive` helper function inside the component (after hooks, before return):
```typescript
const isActive = (item: NavigationItem) => {
  const [itemPath, itemQuery] = item.href.split('?')
  if (pathname !== itemPath) return false
  if (!itemQuery) return true
  const params = new URLSearchParams(itemQuery)
  return [...params.entries()].every(([k, v]) => searchParams.get(k) === v)
}
```

This correctly handles `usePathname()` returning only the path (not query string) by separately checking search params. Without this, pills would never show active state (Research Pitfall 5).

4. Add the category pill row as a second row INSIDE the `<header>`, after the closing `</div>` of the main header row (the `w-full flex h-16` div) but before `</header>`:

```tsx
{/* Category Pill Row — NAV-03 */}
<div className="w-full overflow-x-auto scrollbar-hide border-t border-border/30">
  <div className="flex items-center gap-2 px-4 py-2 min-w-max md:min-w-0 md:justify-center">
    {navigationItems.map((item) => (
      <Link
        key={item.href}
        href={item.href}
        className={cn(
          "flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition-all duration-200",
          isActive(item)
            ? "bg-brand-light text-brand"
            : "text-muted-foreground hover:bg-muted hover:text-foreground"
        )}
      >
        <Image src={item.icon} alt={item.shortName} width={18} height={18} />
        {item.shortName}
      </Link>
    ))}
  </div>
</div>
```

Key details:
- Outer div: `w-full overflow-x-auto scrollbar-hide` — allows horizontal scroll on mobile without causing body-level horizontal scroll (Research Pitfall 2). `scrollbar-hide` is already defined in `globals.css`.
- Inner div: `min-w-max` on mobile ensures pills don't wrap; `md:min-w-0 md:justify-center` centers pills on wider screens.
- Active state: `bg-brand-light text-brand` uses the Phase 1 brand tokens (teal accent), NOT the raw `bg-red-50 text-red-600` from the old navigation.
- `border-t border-border/30` provides a very subtle separator between the main header row and the pill row.
- Icons use `next/image` with `width={18} height={18}` for consistency.

5. The component must be wrapped in `Suspense` if `useSearchParams` causes a client-side boundary issue. However, since `NavigationHeader` is already a `'use client'` component and is rendered inside a `<Suspense>` in `layout.tsx`, this should be fine. If the build fails with a `useSearchParams` error, wrap the pill row section in its own `<Suspense>` with a fallback of an empty div.
  </action>
  <verify>
1. Run `npx tsc --noEmit` — no type errors.
2. In `constants.ts`: verify `navigationItems` has exactly 5 items (grooming, training, boarding, veterinary, adoption).
3. In `navigation-header.tsx`: verify `scrollbar-hide` class is present on the pill row container. Verify `isActive` function uses `useSearchParams()`. Verify no `bg-red-50` or `text-red-600` classes exist.
  </verify>
  <done>
All 5 categories are uncommented in `constants.ts`. A horizontal scrollable pill row with icons renders below the main header bar in `navigation-header.tsx`. Active detection uses `useSearchParams()` for correct query-param matching. Active pills use `bg-brand-light text-brand`.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update layout padding to account for two-row header height</name>
  <files>
    src/components/layout.tsx
  </files>
  <action>
In `src/components/layout.tsx`:

Update the `<main>` element's `pt-16` to `pt-28` (112px = 64px main header + ~48px pill row with padding).

Change:
```tsx
<main className="flex-1 pt-16 md:pb-0">
```

To:
```tsx
<main className="flex-1 pt-28 md:pb-0">
```

`pt-28` = 7rem = 112px. This accounts for:
- Row 1: h-16 (64px) — logo, user actions
- Row 2: ~48px — pill row (py-2 = 16px padding + 18px icon + ~14px text line)

This is a safe estimate. If the pill row renders slightly taller or shorter, the exact value can be fine-tuned during visual verification in a later phase. The priority is that content does not slide behind the header (Research Pitfall 1).

Do NOT use a CSS variable approach for the header height — it adds complexity beyond what's needed for this phase. A fixed `pt-28` value is sufficient and matches the project's existing pattern of using fixed Tailwind spacing.
  </action>
  <verify>
1. Run `npm run build` — build succeeds.
2. In `layout.tsx`: verify `pt-28` is present on the `<main>` element. Verify `pt-16` no longer appears.
  </verify>
  <done>
`layout.tsx` uses `pt-28` on the main element, providing enough top padding to prevent content from hiding behind the expanded two-row header.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with no errors
2. `npm run build` succeeds
3. In `constants.ts`: 5 items in `navigationItems`, 6 items in `serviceTypes`
4. In `navigation-header.tsx`: pill row with `overflow-x-auto scrollbar-hide`, `isActive` function, `useSearchParams()`, brand token active states
5. In `layout.tsx`: `pt-28` on `<main>`, no `pt-16`
6. No `bg-red-50` or `text-red-600` anywhere in the navigation folder
</verification>

<success_criteria>
- 5 category pills (grooming, training, boarding, veterinary, adoption) render in a horizontal row below the main header bar
- Pills scroll horizontally on narrow viewports without causing page-level horizontal scroll
- Clicking a pill navigates to `/search?category={category}`
- The active pill is highlighted with `bg-brand-light text-brand`
- Page content starts below the full header height (no content hidden behind header)
- Build passes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-navigation/02-02-SUMMARY.md`
</output>
